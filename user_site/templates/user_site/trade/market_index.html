{% extends 'user_site/layout.html' %}
{% load static %}
{% load humanize %}
{% block 'main' %}
<style>
    .crypto_card:hover {
        background-color: lightgrey;

        cursor: pointer;
    }
</style>
<div class="row">
    <div class="col-12">
        <div class="card" style="min-height:400px">
            <div class="card-header border-0">
                <form class="" style="width:100%">
                    <div class="row">
                        <div class="col-md-6">
                            <select class="form-control">
                                <option value="crypto" id="search_category">Crypto</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <input type="text" autocomplete="off" placeholder="Search" id="coin_search" class="form-control" >
                            <ul id="crypto_dropdown" style="width:100%"></ul>
                        </div>
                    </div>
                </form>

            </div>

            <div class="row">
                <div class="col-md-12 px-5">


                    {% for crypto in crypto_list %}
                    <div class="crypto_list">
                        <a href="{% url 'trade_room' %}?category=crypto&name={{crypto.id}}&symbol={{crypto.symbol|lower}}">
                            <div id="{{crypto.symbol|lower}}" class="card crypto_card {% if crypto.symbol in user_watch_list %} bg-warning text-white {% endif %}" style="height:100px;padding-top:0px">
                                <div class="card-body d-flex" style="justify-content:space-between">
                                    <img src="{{crypto.image}}" width="70px" height="70px">
                                    <h2 class="fs-4" id="csymbol">{{crypto.symbol|upper}}</h2>
                                    <h2 class="fs-4"><span class="cname">{{crypto.name|title}}</span> <br> ${{crypto.current_price|upper}}</h2>

                                </div>
                            </div>
                        </a>
                    </div>
                    {% endfor %}
                </div>

            </div>


        </div>
    </div>

</div>
<input type="hidden" id="crypto_list" value="{{ crypto_list }}">
<script src="{% static 'admin_site/scripts/jquery.js' %}"></script>


<script>
    $(document).ready(function() {
        // Cache the .crypto_list elements
        const $cryptoLists = $('.crypto_list');

        $('#coin_search').keyup(function() {
            const searchValue = $(this).val().toLowerCase();
            const searchCategory = $('#search_category').val().toLowerCase();

            if (searchCategory === 'crypto') {
                $cryptoLists.each(function() {
                    const $list = $(this);
                    const name = $list.find('.cname').text().toLowerCase();

                    if (name.includes(searchValue)) {
                        $list.show(); // Show element
                    } else {
                        $list.hide(); // Hide element
                    }
                });
            }
        });
    });




</script>

{% endblock %}

