{% extends 'user_site/layout.html' %}
{% load static %}
{% load humanize %}
{% block 'main' %}
<div class="row">
    <div class="col-xl-12">
        <div class="row">
            <div class="col-xl-3 col-sm-6">
                <div class="card box-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="icon-box icon-box-lg bg-success-light rounded">
                                <i class="fa-solid fa-briefcase text-success"></i>
                            </div>
                            <div class="total-projects ms-3">
                                <h3 class="text-success count">{{site_setting.default_currency.symbol}}{{user.user_wallet.holding_balance|floatformat:2|intcomma}}</h3>
                                <span>Holding Balance</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card box-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="icon-box icon-box-lg bg-primary-light rounded">
                                <i class="fa-solid fa-cart-shopping text-primary"></i>

                            </div>
                            <div class="total-projects ms-3">
                                <h3 class="text-primary count">{{site_setting.default_currency.symbol}}{{user.user_wallet.trading_balance|floatformat:2|intcomma}}</h3>
                                <span>Trading Balance</span>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card box-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="icon-box icon-box-lg bg-warning-light rounded">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-currency-exchange" viewBox="0 0 16 16">
                                  <path d="M0 5a5 5 0 0 0 4.027 4.905 6.5 6.5 0 0 1 .544-2.073C3.695 7.536 3.132 6.864 3 5.91h-.5v-.426h.466V5.05q-.001-.07.004-.135H2.5v-.427h.511C3.236 3.24 4.213 2.5 5.681 2.5c.316 0 .59.031.819.085v.733a3.5 3.5 0 0 0-.815-.082c-.919 0-1.538.466-1.734 1.252h1.917v.427h-1.98q-.004.07-.003.147v.422h1.983v.427H3.93c.118.602.468 1.03 1.005 1.229a6.5 6.5 0 0 1 4.97-3.113A5.002 5.002 0 0 0 0 5m16 5.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0m-7.75 1.322c.069.835.746 1.485 1.964 1.562V14h.54v-.62c1.259-.086 1.996-.74 1.996-1.69 0-.865-.563-1.31-1.57-1.54l-.426-.1V8.374c.54.06.884.347.966.745h.948c-.07-.804-.779-1.433-1.914-1.502V7h-.54v.629c-1.076.103-1.808.732-1.808 1.622 0 .787.544 1.288 1.45 1.493l.358.085v1.78c-.554-.08-.92-.376-1.003-.787zm1.96-1.895c-.532-.12-.82-.364-.82-.732 0-.41.311-.719.824-.809v1.54h-.005zm.622 1.044c.645.145.943.38.943.796 0 .474-.37.8-1.02.86v-1.674z"/>
                                </svg>
                            </div>
                            <div class="total-projects ms-3">
                                <h3 class="text-warning count">{{asset_count}}</h3>
                                <span>Assets</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-xl-3 col-sm-6">
                <div class="card box-hover">
                    <div class="card-body">
                        <div class="d-flex align-items-center">
                            <div class="icon-box icon-box-lg bg-danger-light rounded">
                                <i class="fa-solid fa-hand-holding-dollar text-danger"></i>
                            </div>
                            <div class="total-projects ms-3">
                                <h3 class="text-danger count">{{open_trade_count}}</h3>
                                <span>Open Trades</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="">
                <div class="card box-hover">
                    <div class="card-body">
                        <div class="d-flex" style="justify-content:space-between">
                            <a href="{% url 'user_funding_create_1' %}" class="btn btn-primary">Fund Account</a>
                            <a href="{% url 'user_trade_market_index' %}" class="btn btn-primary">Trading Room</a>
                            <a href="{% url 'user_asset_index' %}" class="btn btn-primary">View Assets</a>
                            <a href="{% url 'user_plan_index' 'all' %}" class="btn btn-primary">Trading Plans</a>

                        </div>
                    </div>
                </div>
            </div>


        </div>
    </div>
</div>


<div class="col-xl-12">
    <div class="card dz-card" id="tab-icon">
        <div class="card-header flex-wrap border-0">
            <h4 class="card-title">My Trades</h4>
        </div>
        <div class="tab-content" id="myTabContent7">
            <div class="tab-pane fade show active" id="TabWithIcon" role="tabpanel" aria-labelledby="home-tab7">
                <div class="card-body pt-0">
                    <!-- Nav tabs -->
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#home8">
                                <span>
                                    Open Trades
                                </span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#profile8">
                                <span>
                                    Closed Trades
                                </span>
                            </a>
                        </li>

                    </ul>
                    <!-- Tab panes -->
                    <div class="tab-content tabcontent-border">
                        <div class="tab-pane fade show active" id="home8" role="tabpanel">
                            <div class="pt-4">
                                {% if open_trade_list %}
                                    <div class="table-responsive active-projects user-tbl  dt-filter">
                                        <table id="user-tbl" class="table shorting">
                                            <thead>
                                                <tr>
                                                    <th>S/N</th>
                                                    <th>Asset</th>
                                                    <th>Amount</th>
                                                    <th>Time Place</th>
                                                    <th>End Time</th>
                                                    <th>Direction</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for trade in open_trade_list %}
                                                <tr>
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ trade.symbol|upper }}</td>
                                                    <td>{{site_setting.default_currency.symbol}}{{ trade.amount|floatformat|intcomma }}</td>
                                                    <td>{{ trade.start_time }}</td>
                                                    <td>{{ trade.end_time }}</td>
                                                    <td class="text-center">{% if trade.direction == 'up' %} <i class="bi bi-arrow-up fs-4 text-success"></i> {% else %} <i class="bi bi-arrow-down fs-4 text-danger"></i>  {% endif %}</td>

                                                    <td>
                                                        <div class="dropdown">
                                                            <div class="btn-link" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                    <path d="M11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M18 12C18 12.5523 18.4477 13 19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M4 12C4 12.5523 4.44772 13 5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                </svg>
                                                            </div>
                                                            <div class="dropdown-menu dropdown-menu-right" style="">
                                                                <a class="dropdown-item text-warning" href="#" data-bs-toggle="modal" data-bs-target="#editdept{{ forloop.counter }}">Update</a>
                                                                <a class="dropdown-item text-danger" href="{ url 'mining_plan_delete' plan.id %}">Delete</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>

                                        </table>
                                    </div>
                                {% else %}
                                <h4>No Open Trade</h4>
                                {% endif %}

                            </div>
                        </div>
                        <div class="tab-pane fade" id="profile8" role="tabpanel">
                            <div class="pt-4">
                                {% if close_trade_list %}
                                    <div class="table-responsive active-projects user-tbl  dt-filter">
                                        <table id="user-tbl" class="table shorting">
                                            <thead>
                                                <tr>
                                                    <th>S/N</th>
                                                    <th>Asset</th>
                                                    <th>Amount</th>
                                                    <th>Time Place</th>
                                                    <th>End Time</th>
                                                    <th>Profit</th>
                                                    <th>Action</th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                {% for trade in close_trade_list %}
                                                <tr>
                                                    <td>{{ forloop.counter }}</td>
                                                    <td>{{ trade.symbol|upper }}</td>
                                                    <td>{{site_setting.default_currency.symbol}}{{ trade.amount|floatformat|intcomma }}</td>
                                                    <td>{{ trade.start_time }}</td>
                                                    <td>{{ trade.end_time }}</td>
                                                    <td>{{site_setting.default_currency.symbol}}{{ trade.profit|floatformat|intcomma }}</td>

                                                    <td>
                                                        <div class="dropdown">
                                                            <div class="btn-link" data-bs-toggle="dropdown" aria-expanded="false">
                                                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                                                    <path d="M11 12C11 12.5523 11.4477 13 12 13C12.5523 13 13 12.5523 13 12C13 11.4477 12.5523 11 12 11C11.4477 11 11 11.4477 11 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M18 12C18 12.5523 18.4477 13 19 13C19.5523 13 20 12.5523 20 12C20 11.4477 19.5523 11 19 11C18.4477 11 18 11.4477 18 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                    <path d="M4 12C4 12.5523 4.44772 13 5 13C5.55228 13 6 12.5523 6 12C6 11.4477 5.55228 11 5 11C4.44772 11 4 11.4477 4 12Z" stroke="#737B8B" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                                                </svg>
                                                            </div>
                                                            <div class="dropdown-menu dropdown-menu-right" style="">
                                                                <a class="dropdown-item text-primary" href="{% url 'user_trade_detail' trade.id %}">Detail</a>
                                                            </div>
                                                        </div>
                                                    </td>
                                                </tr>
                                            {% endfor %}
                                            </tbody>

                                        </table>
                                    </div>
                                {% else %}
                                <h4>No Close Trade</h4>
                                {% endif %}

                            </div>
                        </div>
                        <div class="tab-pane fade" id="messages8" role="tabpanel">
                            <div class="pt-4">
                                <h4>This is icon title</h4>
                                <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting
                                </p>
                                <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card" style="min-height:400px">
            <div class="card-header border-0">
                <div>
                    <h4 class="heading mb-0">Market Trend</h4>
                    <span></span>
                </div>
            </div>

            <!-- TradingView Widget BEGIN -->
                <div class="tradingview-widget-container" style="height:100%;width:100%">
                  <div class="tradingview-widget-container__widget" style="height:calc(100% - 32px);width:100%"></div>

                  <script type="text/javascript" src="https://s3.tradingview.com/external-embedding/embed-widget-advanced-chart.js" async>
                  {
                  "autosize": true,
                  "symbol": "BTCUSD",
                  "interval": "D",
                  "timezone": "Etc/UTC",
                  "theme": "light",
                  "style": "1",
                  "locale": "en",
                  "allow_symbol_change": true,
                  "calendar": false,
                  "support_host": "https://www.tradingview.com"
                }
                  </script>
                </div>
                <!-- TradingView Widget END -->
        </div>
    </div>

</div>

{% endblock %}

